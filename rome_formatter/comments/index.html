<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Types for extracting and representing comments of a syntax tree."><meta name="keywords" content="rust, rustlang, rust-lang, comments"><title>rome_formatter::comments - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../../SourceSerif4-Regular.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../FiraSans-Regular.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../FiraSans-Medium.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../SourceCodePro-Regular.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../SourceSerif4-Bold.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../SourceCodePro-Semibold.ttf.woff2"><link rel="stylesheet" type="text/css" href="../../normalize.css"><link rel="stylesheet" type="text/css" href="../../rustdoc.css" id="mainThemeStyle"><link rel="stylesheet" type="text/css" href="../../ayu.css" disabled><link rel="stylesheet" type="text/css" href="../../dark.css" disabled><link rel="stylesheet" type="text/css" href="../../light.css" id="themeStyle"><script id="default-settings" ></script><script src="../../storage.js"></script><script defer src="../../main.js"></script><noscript><link rel="stylesheet" href="../../noscript.css"></noscript><link rel="alternate icon" type="image/png" href="../../favicon-16x16.png"><link rel="alternate icon" type="image/png" href="../../favicon-32x32.png"><link rel="icon" type="image/svg+xml" href="../../favicon.svg"></head><body class="rustdoc mod"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="sidebar-logo" href="../../rome_formatter/index.html"><div class="logo-container"><img class="rust-logo" src="../../rust-logo.svg" alt="logo"></div></a><h2 class="location"></h2></nav><nav class="sidebar"><a class="sidebar-logo" href="../../rome_formatter/index.html"><div class="logo-container"><img class="rust-logo" src="../../rust-logo.svg" alt="logo"></div></a><h2 class="location"><a href="#">Module comments</a></h2><div class="sidebar-elems"><section><div class="block"><ul><li><a href="#structs">Structs</a></li><li><a href="#enums">Enums</a></li><li><a href="#traits">Traits</a></li></ul></div></section></div></nav><main><div class="width-limiter"><div class="sub-container"><a class="sub-logo-container" href="../../rome_formatter/index.html"><img class="rust-logo" src="../../rust-logo.svg" alt="logo"></a><nav class="sub"><form class="search-form"><div class="search-container"><span></span><input class="search-input" name="search" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><div id="help-button" title="help" tabindex="-1"><button type="button">?</button></div><div id="settings-menu" tabindex="-1"><a href="../../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../../wheel.svg"></a></div></div></form></nav></div><section id="main-content" class="content"><div class="main-heading"><h1 class="fqn"><span class="in-band">Module <a href="../index.html">rome_formatter</a>::<wbr><a class="mod" href="#">comments</a><button id="copy-path" onclick="copy_path(this)" title="Copy item path to clipboard"><img src="../../clipboard.svg" width="19" height="18" alt="Copy item path"></button></span></h1><span class="out-of-band"><a class="srclink" href="../../src/rome_formatter/comments.rs.html#1-1144">source</a> · <a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">[<span class="inner">&#x2212;</span>]</a></span></div><details class="rustdoc-toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Types for extracting and representing comments of a syntax tree.</p>
<p>Most programming languages support comments allowing programmers to document their programs. Comments are different from other syntaxes  because programming languages allow comments in almost any position, giving programmers great flexibility on where they can write comments:</p>

<div class='information'><div class='tooltip ignore'>ⓘ</div></div><div class="example-wrap"><pre class="rust rust-example-rendered ignore"><code><span class="doccomment">/**
 * Documentation comment
 */</span>
<span class="kw">async</span> <span class="comment">/* comment */</span> <span class="ident">function</span> <span class="ident">Test</span> () <span class="comment">// line comment</span>
{<span class="comment">/*inline*/</span>}</code></pre></div>
<p>However, this flexibility makes formatting comments challenging because:</p>
<ul>
<li>The formatter must consistently place comments so that re-formatting the output yields the same result and does not create invalid syntax (line comments).</li>
<li>It is essential that formatters place comments close to the syntax the programmer intended to document. However, the lack of rules regarding where comments are allowed and what syntax they document requires the use of heuristics to infer the documented syntax.</li>
</ul>
<p>This module strikes a balance between placing comments as closely as possible to their source location and reducing the complexity of formatting comments. It does so by associating comments per node rather than a token. This greatly reduces the combinations of possible comment positions but turns out to be, in practice, sufficiently precise to keep comments close to their source location.</p>
<h3 id="node-comments"><a href="#node-comments">Node comments</a></h3>
<p>Comments are associated per node but get further distinguished on their location related to that node:</p>
<h4 id="leading-comments"><a href="#leading-comments">Leading Comments</a></h4>
<p>A comment at the start of a node</p>

<div class='information'><div class='tooltip ignore'>ⓘ</div></div><div class="example-wrap"><pre class="rust rust-example-rendered ignore"><code><span class="comment">// Leading comment of the statement</span>
<span class="ident">console</span>.<span class="ident">log</span>(<span class="string">&quot;test&quot;</span>);

[<span class="comment">/* leading comment of identifier */</span> <span class="ident">a</span> ];</code></pre></div>
<h4 id="dangling-comments"><a href="#dangling-comments">Dangling Comments</a></h4>
<p>A comment that is neither at the start nor the end of a node</p>

<div class='information'><div class='tooltip ignore'>ⓘ</div></div><div class="example-wrap"><pre class="rust rust-example-rendered ignore"><code>[<span class="comment">/* in between the brackets */</span> ];
<span class="kw">async</span>  <span class="comment">/* between keywords */</span>  <span class="ident">function</span> <span class="ident">Test</span> () {}</code></pre></div>
<h4 id="trailing-comments"><a href="#trailing-comments">Trailing Comments</a></h4>
<p>A comment at the end of a node</p>

<div class='information'><div class='tooltip ignore'>ⓘ</div></div><div class="example-wrap"><pre class="rust rust-example-rendered ignore"><code>[<span class="ident">a</span> <span class="comment">/* trailing comment of a */</span>, <span class="ident">b</span>, <span class="ident">c</span>];
[
    <span class="ident">a</span> <span class="comment">// trailing comment of a</span>
]</code></pre></div>
<h3 id="limitations"><a href="#limitations">Limitations</a></h3>
<p>Limiting the placement of comments to leading, dangling, or trailing node comments reduces complexity inside the formatter but means, that the formatter’s possibility of where comments can be formatted depends on the AST structure.</p>
<p>For example, the continue statement in JavaScript is defined as:</p>
<div class="example-wrap"><pre class="language-ungram"><code>JsContinueStatement =
&#39;continue&#39;
(label: &#39;ident&#39;)?
&#39;;&#39;?</code></pre></div>
<p>but a programmer may decide to add a comment in front or after the label:</p>

<div class='information'><div class='tooltip ignore'>ⓘ</div></div><div class="example-wrap"><pre class="rust rust-example-rendered ignore"><code><span class="kw">continue</span> <span class="comment">/* comment 1 */</span> <span class="ident">label</span>;
<span class="kw">continue</span> <span class="ident">label</span> <span class="comment">/* comment 2*/</span>; <span class="comment">/* trailing */</span></code></pre></div>
<p>Because all children of the <code>continue</code> statement are tokens, it is only possible to make the comments leading, dangling, or trailing comments of the <code>continue</code> statement. But this results in a loss of information as the formatting code can no longer distinguish if a comment appeared before or after the label and, thus, has to format them the same way.</p>
<p>This hasn’t shown to be a significant limitation today but the infrastructure could be extended to support a <code>label</code> on <a href="struct.SourceComment.html" title="SourceComment"><code>SourceComment</code></a> that allows to further categorise comments.</p>
</div></details><h2 id="structs" class="small-section-header"><a href="#structs">Structs</a></h2><div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.Comments.html" title="rome_formatter::comments::Comments struct">Comments</a></div><div class="item-right docblock-short"><p>The comments of a syntax tree stored by node.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.DecoratedComment.html" title="rome_formatter::comments::DecoratedComment struct">DecoratedComment</a></div><div class="item-right docblock-short"><p>A comment decorated with additional information about its surrounding context in the source document.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.SourceComment.html" title="rome_formatter::comments::SourceComment struct">SourceComment</a></div><div class="item-right docblock-short"><p>A comment in the source document.</p>
</div></div></div><h2 id="enums" class="small-section-header"><a href="#enums">Enums</a></h2><div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="enum" href="enum.CommentKind.html" title="rome_formatter::comments::CommentKind enum">CommentKind</a></div><div class="item-right docblock-short"></div></div><div class="item-row"><div class="item-left module-item"><a class="enum" href="enum.CommentPlacement.html" title="rome_formatter::comments::CommentPlacement enum">CommentPlacement</a></div><div class="item-right docblock-short"></div></div><div class="item-row"><div class="item-left module-item"><a class="enum" href="enum.CommentTextPosition.html" title="rome_formatter::comments::CommentTextPosition enum">CommentTextPosition</a></div><div class="item-right docblock-short"><p>The position of a comment in the source text.</p>
</div></div></div><h2 id="traits" class="small-section-header"><a href="#traits">Traits</a></h2><div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="trait" href="trait.CommentStyle.html" title="rome_formatter::comments::CommentStyle trait">CommentStyle</a></div><div class="item-right docblock-short"><p>Defines how to format comments for a specific <a href="../../rome_rowan/syntax/trait.Language.html" title="Language">Language</a>.</p>
</div></div></div></section></div></main><div id="rustdoc-vars" data-root-path="../../" data-current-crate="rome_formatter" data-themes="ayu,dark,light" data-resource-suffix="" data-rustdoc-version="1.64.0 (a55dd71d5 2022-09-19)" ></div></body></html>