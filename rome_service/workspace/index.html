<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="The [Workspace] is the main entry point for high-level clients (the Rome CLI and Language Server) into the various language-specific services of the Rome toolchain (parser, formatter, analyzer …)"><meta name="keywords" content="rust, rustlang, rust-lang, workspace"><title>rome_service::workspace - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../../SourceSerif4-Regular.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../FiraSans-Regular.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../FiraSans-Medium.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../SourceCodePro-Regular.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../SourceSerif4-Bold.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../SourceCodePro-Semibold.ttf.woff2"><link rel="stylesheet" type="text/css" href="../../normalize.css"><link rel="stylesheet" type="text/css" href="../../rustdoc.css" id="mainThemeStyle"><link rel="stylesheet" type="text/css" href="../../ayu.css" disabled><link rel="stylesheet" type="text/css" href="../../dark.css" disabled><link rel="stylesheet" type="text/css" href="../../light.css" id="themeStyle"><script id="default-settings" ></script><script src="../../storage.js"></script><script defer src="../../main.js"></script><noscript><link rel="stylesheet" href="../../noscript.css"></noscript><link rel="alternate icon" type="image/png" href="../../favicon-16x16.png"><link rel="alternate icon" type="image/png" href="../../favicon-32x32.png"><link rel="icon" type="image/svg+xml" href="../../favicon.svg"></head><body class="rustdoc mod"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="sidebar-logo" href="../../rome_service/index.html"><div class="logo-container"><img class="rust-logo" src="../../rust-logo.svg" alt="logo"></div></a><h2 class="location"></h2></nav><nav class="sidebar"><a class="sidebar-logo" href="../../rome_service/index.html"><div class="logo-container"><img class="rust-logo" src="../../rust-logo.svg" alt="logo"></div></a><h2 class="location"><a href="#">Module workspace</a></h2><div class="sidebar-elems"><section><div class="block"><ul><li><a href="#structs">Structs</a></li><li><a href="#enums">Enums</a></li><li><a href="#traits">Traits</a></li><li><a href="#functions">Functions</a></li></ul></div></section></div></nav><main><div class="width-limiter"><div class="sub-container"><a class="sub-logo-container" href="../../rome_service/index.html"><img class="rust-logo" src="../../rust-logo.svg" alt="logo"></a><nav class="sub"><form class="search-form"><div class="search-container"><span></span><input class="search-input" name="search" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><div id="help-button" title="help" tabindex="-1"><button type="button">?</button></div><div id="settings-menu" tabindex="-1"><a href="../../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../../wheel.svg"></a></div></div></form></nav></div><section id="main-content" class="content"><div class="main-heading"><h1 class="fqn"><span class="in-band">Module <a href="../index.html">rome_service</a>::<wbr><a class="mod" href="#">workspace</a><button id="copy-path" onclick="copy_path(this)" title="Copy item path to clipboard"><img src="../../clipboard.svg" width="19" height="18" alt="Copy item path"></button></span></h1><span class="out-of-band"><a class="srclink" href="../../src/rome_service/workspace.rs.html#1-513">source</a> · <a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">[<span class="inner">&#x2212;</span>]</a></span></div><details class="rustdoc-toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>The <a href="trait.Workspace.html" title="Workspace">Workspace</a> is the main entry point for high-level clients (the Rome
CLI and Language Server) into the various language-specific services of the
Rome toolchain (parser, formatter, analyzer …)</p>
<h2 id="documents"><a href="#documents">Documents</a></h2>
<p>A <a href="trait.Workspace.html" title="Workspace">Workspace</a> instance operates on a set of open documents managed by one
or multiple clients, and provides language services for these documents
like diagnostics, code actions or formatting in a language independent way.</p>
<p>In this regard the <a href="trait.Workspace.html" title="Workspace">Workspace</a> trait shares many similarities with the
Language Server Protocol, and in the context of the Language Server the
state of the <a href="trait.Workspace.html" title="Workspace">Workspace</a> instance is intended to closely mirror the state
of the actual in-editor workspace (the set of documents open in the
<a href="trait.Workspace.html" title="Workspace">Workspace</a> is the set of files currently open in the editor)</p>
<p>In the context of the CLI most commands will generally work on batches of
files, and as such the set of “open documents” instead corresponds to the
list of files the CLI is currently actively processing</p>
<h2 id="state"><a href="#state">State</a></h2>
<p>A <a href="trait.Workspace.html" title="Workspace">Workspace</a> instance is stateful: this is not reflected on the trait (all
methods take an immutable <code>&amp;self</code> borrow) because the interface is also
required to be thread-safe (<a href="https://doc.rust-lang.org/1.64.0/core/marker/trait.Send.html" title="Send">Send</a> + <a href="https://doc.rust-lang.org/1.64.0/core/marker/trait.Sync.html" title="Sync">Sync</a>), but the workspace is allowed
to internally cache data across calls (this is in fact the main reason for
the use of the “open documents” set, those documents can serve as
conceptual garbage collection roots to manage the caching and eviction of
parse trees, intermediate analysis data or diagnostics)</p>
<h2 id="implementations-1"><a href="#implementations-1">Implementations</a></h2>
<p>Currently the <a href="trait.Workspace.html" title="Workspace">Workspace</a> trait is implemented for a single <code>WorkspaceServer</code>
type. However it is eventually intended to also be implemented for a
potential <code>WorkspaceClient</code> type and to operate on a remote workspace
server through a transport layer. This would allow the CLI and Language
Server process to share a the same <a href="trait.Workspace.html" title="Workspace">Workspace</a> instance in a common daemon
process for instance</p>
<h2 id="errors"><a href="#errors">Errors</a></h2>
<p>Because of the aforementioned client-server abstraction, the <a href="trait.Workspace.html" title="Workspace">Workspace</a>
is designed to let any operation fail: all methods return a <a href="https://doc.rust-lang.org/1.64.0/core/result/enum.Result.html" title="Result">Result</a> with a
<a href="../enum.RomeError.html" title="RomeError">RomeError</a> enum wrapping the underlying issue. Some common errors are:</p>
<ul>
<li><a href="../enum.RomeError.html#variant.NotFound" title="RomeError::NotFound">RomeError::NotFound</a>: This error is returned when an operation is being
run on a path that doesn’t correspond to any open document: either the
document has been closed or the client didn’t open it in the first place</li>
<li><a href="../enum.RomeError.html#variant.SourceFileNotSupported" title="RomeError::SourceFileNotSupported">RomeError::SourceFileNotSupported</a>: This error is returned when an
operation could not be completed because the language associated with the
document does not implement the required capability: for instance trying to
format a file with a language that does not have a formatter</li>
</ul>
</div></details><h2 id="structs" class="small-section-header"><a href="#structs">Structs</a></h2><div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.ChangeFileParams.html" title="rome_service::workspace::ChangeFileParams struct">ChangeFileParams</a></div><div class="item-right docblock-short"></div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.CloseFileParams.html" title="rome_service::workspace::CloseFileParams struct">CloseFileParams</a></div><div class="item-right docblock-short"></div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.CodeAction.html" title="rome_service::workspace::CodeAction struct">CodeAction</a></div><div class="item-right docblock-short"></div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.FileGuard.html" title="rome_service::workspace::FileGuard struct">FileGuard</a></div><div class="item-right docblock-short"><p><a href="https://en.wikipedia.org/wiki/Resource_acquisition_is_initialization">RAII</a>
guard for an open file in a workspace, takes care of closing the file
automatically on drop</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.FixAction.html" title="rome_service::workspace::FixAction struct">FixAction</a></div><div class="item-right docblock-short"></div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.FixFileParams.html" title="rome_service::workspace::FixFileParams struct">FixFileParams</a></div><div class="item-right docblock-short"></div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.FixFileResult.html" title="rome_service::workspace::FixFileResult struct">FixFileResult</a></div><div class="item-right docblock-short"></div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.FormatFileParams.html" title="rome_service::workspace::FormatFileParams struct">FormatFileParams</a></div><div class="item-right docblock-short"></div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.FormatOnTypeParams.html" title="rome_service::workspace::FormatOnTypeParams struct">FormatOnTypeParams</a></div><div class="item-right docblock-short"></div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.FormatRangeParams.html" title="rome_service::workspace::FormatRangeParams struct">FormatRangeParams</a></div><div class="item-right docblock-short"></div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.GetControlFlowGraphParams.html" title="rome_service::workspace::GetControlFlowGraphParams struct">GetControlFlowGraphParams</a></div><div class="item-right docblock-short"></div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.GetFormatterIRParams.html" title="rome_service::workspace::GetFormatterIRParams struct">GetFormatterIRParams</a></div><div class="item-right docblock-short"></div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.GetSyntaxTreeParams.html" title="rome_service::workspace::GetSyntaxTreeParams struct">GetSyntaxTreeParams</a></div><div class="item-right docblock-short"></div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.GetSyntaxTreeResult.html" title="rome_service::workspace::GetSyntaxTreeResult struct">GetSyntaxTreeResult</a></div><div class="item-right docblock-short"></div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.OpenFileParams.html" title="rome_service::workspace::OpenFileParams struct">OpenFileParams</a></div><div class="item-right docblock-short"></div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.PullActionsParams.html" title="rome_service::workspace::PullActionsParams struct">PullActionsParams</a></div><div class="item-right docblock-short"></div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.PullActionsResult.html" title="rome_service::workspace::PullActionsResult struct">PullActionsResult</a></div><div class="item-right docblock-short"></div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.PullDiagnosticsParams.html" title="rome_service::workspace::PullDiagnosticsParams struct">PullDiagnosticsParams</a></div><div class="item-right docblock-short"></div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.PullDiagnosticsResult.html" title="rome_service::workspace::PullDiagnosticsResult struct">PullDiagnosticsResult</a></div><div class="item-right docblock-short"></div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.RageParams.html" title="rome_service::workspace::RageParams struct">RageParams</a></div><div class="item-right docblock-short"></div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.RageResult.html" title="rome_service::workspace::RageResult struct">RageResult</a></div><div class="item-right docblock-short"></div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.RenameParams.html" title="rome_service::workspace::RenameParams struct">RenameParams</a></div><div class="item-right docblock-short"></div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.RenameResult.html" title="rome_service::workspace::RenameResult struct">RenameResult</a></div><div class="item-right docblock-short"></div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.RuleCategories.html" title="rome_service::workspace::RuleCategories struct">RuleCategories</a></div><div class="item-right docblock-short"></div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.ServerInfo.html" title="rome_service::workspace::ServerInfo struct">ServerInfo</a></div><div class="item-right docblock-short"></div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.SupportsFeatureParams.html" title="rome_service::workspace::SupportsFeatureParams struct">SupportsFeatureParams</a></div><div class="item-right docblock-short"></div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.SupportsFeatureResult.html" title="rome_service::workspace::SupportsFeatureResult struct">SupportsFeatureResult</a></div><div class="item-right docblock-short"></div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.TransportRequest.html" title="rome_service::workspace::TransportRequest struct">TransportRequest</a></div><div class="item-right docblock-short"></div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.UpdateSettingsParams.html" title="rome_service::workspace::UpdateSettingsParams struct">UpdateSettingsParams</a></div><div class="item-right docblock-short"></div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.WorkspaceClient.html" title="rome_service::workspace::WorkspaceClient struct">WorkspaceClient</a></div><div class="item-right docblock-short"></div></div></div><h2 id="enums" class="small-section-header"><a href="#enums">Enums</a></h2><div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="enum" href="enum.FeatureName.html" title="rome_service::workspace::FeatureName enum">FeatureName</a></div><div class="item-right docblock-short"></div></div><div class="item-row"><div class="item-left module-item"><a class="enum" href="enum.FixFileMode.html" title="rome_service::workspace::FixFileMode enum">FixFileMode</a></div><div class="item-right docblock-short"><p>Which fixes should be applied during the analyzing phase</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="enum" href="enum.Language.html" title="rome_service::workspace::Language enum">Language</a></div><div class="item-right docblock-short"><p>Supported languages by Rome</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="enum" href="enum.RageEntry.html" title="rome_service::workspace::RageEntry enum">RageEntry</a></div><div class="item-right docblock-short"></div></div><div class="item-row"><div class="item-left module-item"><a class="enum" href="enum.UnsupportedReason.html" title="rome_service::workspace::UnsupportedReason enum">UnsupportedReason</a></div><div class="item-right docblock-short"></div></div></div><h2 id="traits" class="small-section-header"><a href="#traits">Traits</a></h2><div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="trait" href="trait.Workspace.html" title="rome_service::workspace::Workspace trait">Workspace</a></div><div class="item-right docblock-short"></div></div><div class="item-row"><div class="item-left module-item"><a class="trait" href="trait.WorkspaceTransport.html" title="rome_service::workspace::WorkspaceTransport trait">WorkspaceTransport</a></div><div class="item-right docblock-short"></div></div></div><h2 id="functions" class="small-section-header"><a href="#functions">Functions</a></h2><div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="fn" href="fn.client.html" title="rome_service::workspace::client fn">client</a></div><div class="item-right docblock-short"><p>Convenience function for constructing a client instance of <a href="trait.Workspace.html" title="Workspace">Workspace</a></p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="fn" href="fn.server.html" title="rome_service::workspace::server fn">server</a></div><div class="item-right docblock-short"><p>Convenience function for constructing a server instance of <a href="trait.Workspace.html" title="Workspace">Workspace</a></p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="fn" href="fn.server_sync.html" title="rome_service::workspace::server_sync fn">server_sync</a></div><div class="item-right docblock-short"><p>Convenience function for constructing a server instance of <a href="trait.Workspace.html" title="Workspace">Workspace</a></p>
</div></div></div></section></div></main><div id="rustdoc-vars" data-root-path="../../" data-current-crate="rome_service" data-themes="ayu,dark,light" data-resource-suffix="" data-rustdoc-version="1.64.0 (a55dd71d5 2022-09-19)" ></div></body></html>